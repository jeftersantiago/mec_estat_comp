\begin{minted}{fortran}

        dimension betas(1:5)
        parameter(betas = (/0.41, 0.44, 0.47, 0.51, 0.55/))

        open(1, file="saidas/tarefa-3/saida-tarefa-C2-L60-b1.dat")
        open(2, file="saidas/tarefa-3/saida-tarefa-C2-L60-b2.dat")
        open(3, file="saidas/tarefa-3/saida-tarefa-C2-L60-b3.dat")
        open(4, file="saidas/tarefa-3/saida-tarefa-C2-L60-b4.dat")
        open(5, file="saidas/tarefa-3/saida-tarefa-C2-L60-b5.dat")

        do i = 1, 5
            call tarefaC2(60, betas(i), i)
            close(1)
        end do

        open(1, file="saidas/tarefa-3/saida-tarefa-C2-L80-b1.dat")
        open(2, file="saidas/tarefa-3/saida-tarefa-C2-L80-b2.dat")
        open(3, file="saidas/tarefa-3/saida-tarefa-C2-L80-b3.dat")
        open(4, file="saidas/tarefa-3/saida-tarefa-C2-L80-b4.dat")
        open(5, file="saidas/tarefa-3/saida-tarefa-C2-L80-b5.dat")

        do i = 1, 5
            call tarefaC2(80, betas(i), i)
            close(1)
        end do

        open(1, file="saidas/tarefa-3/saida-tarefa-C2-L100-b1.dat")
        open(2, file="saidas/tarefa-3/saida-tarefa-C2-L100-b2.dat")
        open(3, file="saidas/tarefa-3/saida-tarefa-C2-L100-b3.dat")
        open(4, file="saidas/tarefa-3/saida-tarefa-C2-L100-b4.dat")
        open(5, file="saidas/tarefa-3/saida-tarefa-C2-L100-b5.dat")

        do i = 1, 5
            call tarefaC2(100, betas(i), i)
            close(1)
        end do
        end
        subroutine tarefaC2(L_real, beta, fname)
!               Tarefa B - Recozimento e quenching
            implicit integer(f-f)
            implicit real(j-j, m-m)
            parameter(L = 100)
            dimension exps(-4:4)
            byte lattice(1:L, 1:L)
            ! periodic boundary conditions
            dimension ipbc(0:L+1)

            do i = 1, L_real
                ipbc(i) = i
            end do  

            ipbc(0) = L_real
            ipbc(L_real+1) = 1

            N = L_real * L_real

            mag = 0.0d0

            call srand(L_real * 392)

            ! half ordered / half random.
            call initialize_lattice(lattice, L_real, L_real)
            call initialize_random_lattice(lattice,  L_real/2, L_real)

            open(99, file = "saidas/tarefa-3/saida-tarefa-C2-conf.dat")
            call write_lattice(lattice, L_real, 99)
            close(99)

            call total_magnetization(lattice, mag, L_real)

            ! initial energy
            E = H_0(lattice, ipbc, L_real)
            dbeta = 0.01
            write(fname, *) 0, E/N
            do i = 1, 3000
                call define_exponentials(exps, beta)
                do k = 1 , N
                    call flip_spin(lattice,ipbc,exps,E,mag,L_real)
                end do   
                write(fname, *) i, E/N
            end do
        end subroutine tarefaC2
\end{minted}